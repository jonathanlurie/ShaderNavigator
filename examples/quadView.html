<!DOCTYPE html>
<html lang="en">
	<head>
		<title>BigBrain Quadview</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<style>
			body {
				color: #000;
				font-family:Monospace;
				font-size:13px;
				text-align:center;

				background-color: #fff;
				margin: 0px;
				overflow: hidden;
			}

			#info {
				position: absolute;
				top: 0px; width: 100%;
				padding: 5px;

			}

      .key{
        font-size: larger;
        background-color: #fff;
        padding: 1px 6px 1px 6px;
        font-weight: 900;
        border-style: solid;
        border-width: 1px;
        border-color: #6b6b6b;
        border-bottom-width: 3px;
        border-radius: 5px;
      }

			a {
				color: #0080ff;
			}

      #container{
        cursor: default;
      }

      .noselect {
        -webkit-touch-callout: none; /* iOS Safari */
        -webkit-user-select: none; /* Chrome/Safari/Opera */
        -khtml-user-select: none; /* Konqueror */
        -moz-user-select: none; /* Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
        user-select: none; /* Non-prefixed version, currently
                                  not supported by any browser */
      }

		</style>
	</head>
	<body>

		<div id="container"></div>
		<div id="info" class="noselect">
      <p>
        BigBrain Quadview â€” use mouse to pan, <span class="key">R</span> + mouse to rotate, <span class="key">T</span> + mouse to transverse rotate, <span class="key">&#8593;</span> and <span class="key">&#8595;</span> to go forward/backward on the view the mouse hovers.
      </p>
      <p>
        You can also share the URL because it is specific to the current view.
      </p>
    </div>

		<script src="js/three.js"></script>
    <!-- <script src="js/OrbitControls.js"></script> -->
    <script src="js/TrackballControls.js"></script>
		<script src="js/Detector.js"></script>
		<script src="js/stats.min.js"></script>
    <script src="js/dat.gui.js"></script>
    <script src="js/jpg.js"></script>

    <!-- importing the automatically build module -->
    <script src="../build/shadernavigator/shadernavigator.js"></script>
    <!--<script src="../build/shadernavigator/shadernavigator.min.js"></script>-->

		<script>

    var quadScene = new SHAD.QuadScene("container", 0);


    // loads the octree of texture chunks
    quadScene.loadData({
        datatype: "precomputed_octree_tiles",
        url: "../data_raster/info2.json"
        //url: "http://132.216.122.238/jpeg/info2.json"
    });

    /*
    quadScene.loadData({
        datatype: "mesh_collection",
        //url: "../data_mesh/meshes/bigbrain_white.json"
        url: "../data_mesh/meshes/bigbrain_gray.json"
        //url: "../data_mesh/meshes/bigbrain_white_grey.json"
    });
    */

    // optional: display some performances
    quadScene.initStat();

    // to read the URL hash info
    var hashIo = new SHAD.HashIO();
    var hashInfo = hashIo.getHashInfo();

    // when the quadscene is ready
    quadScene.onReady(function(qs){

      // if position info in the URL, we go there
      if(hashInfo){
        // position
        qs.setMultiplanePosition(
          hashInfo.position.x,
          hashInfo.position.y,
          hashInfo.position.z
        );

        // rotation
        qs.setMultiplaneRotation(
          hashInfo.rotation.x,
          hashInfo.rotation.y,
          hashInfo.rotation.z
        );

        // resolution level - MUST be last to be sure not to load unused chunks (except the few of level 0)
        qs.setResolutionLevel(hashInfo.resolutionLvl);

      // if no position is mentioned in the URL, the location is at the center,
      // but we can change things like rezLvl, position or rotation
      }else{
        qs.setResolutionLevel(4);
        //qs.setMainObjectRotation(1, 0.2, 0.6);
        //qs.setMainObjectPosition(0.3, 0.41, 0.8);
      }

    });


    // when
    quadScene.onUpdateView( function(objectInfo){
      hashIo.setHashInfo(objectInfo);
    });


    quadScene.onConfigFileError(function(url, code){

      if(code == 0){
        alert("The config file:\n" + url + "\nfailed to load. (code " + code + ")");
      }

    });

		</script>

	</body>
</html>
